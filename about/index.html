<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>About | FIXLAG.ART</title>
  <meta name="description" content="About | FIXLAG.ART — a personal portal curating live notes, studies on industrial heritage, leisurely drives, and gadgets.">
  <link rel="stylesheet" href="/assets/common.css">
</head>
<body>
<div class="layout">
  <!-- : 左・共通サイドナビ -->
  <nav class="sidenav" aria-label="Global">
    <div class="logo">FIXLAG.ART</div>
    <a href="/">Nexus</a>
    <a href="/sonic/">Sonic</a>
    <a href="/relic/">Relic</a>
    <a href="/velox/">Velox</a>
    <a href="/gizmo/">Gizmo</a>
    <div class="sep"></div>
  </nav>

  <!-- : 右・本文 -->
  <main class="content">
    <!-- 横帯（Top / About のみ） -->
    <nav class="subnav" aria-label="About sections" data-base="/about/"></nav>
    <script id="subnav-data" type="application/json">
      [
        ["Top", "/"],
        ["About", "/about/"]
      ]
    </script>

    <article class="page">
      <h1 style="margin:6px 0 12px;">About</h1>

      <div class="card" style="margin-bottom:12px;">
        <p class="lead" style="margin:.2rem 0 .6rem;">
          A personal portal curating live notes, studies on industrial heritage, leisurely drives, and
          gadgets—written in a restrained, cordial tone.
        </p>
        <p style="margin:.6rem 0;">
          本サイトは、書きつけメモ・産業遺構の研究・ドライブ・ガジェットの記録を
          控えめで丁寧な文体でまとめる個人ポータルです。
        </p>
      </div>

      <div class="card">
        <h3 style="margin:.2rem 0 .6rem;">Contact</h3>
        <p style="margin:0;">
          E-mail: <a href="mailto:receipt.desk@fixlag.org">receipt.desk@fixlag.org</a>
        </p>
      </div>

      <!-- ▼ 明示的にフッターを呼び出す（Notice=ON / Copyright=OFF / GA=ON） -->
      <div id="site-footer"
        data-notice="on"
        data-copyright="off"
        data-ga="on"></div>
    </article>
  </main>
</div>

<!-- scripts -->
<script defer src="/assets/subnav.js"></script>
<script defer src="/assets/common.js"></script>
</body>
</html>

// ===== Footer (notice / ga / copyright) =====
(function () {
  // 既に実行済みガード（多重挿入防止）
  if (window.__footerInjected) return;
  window.__footerInjected = true;

  // フッター描画本体
  function buildFooterHTML(flags) {
    const items = [];
    if (flags.notice !== 'off') {
      items.push(`
      <div class="card" style="margin:0;padding-left:1rem">
        <ul style="margin:.6rem 0">
          <li>This site uses Google Analytics (GA4) for traffic measurement. Cookies may be used.<br>本サイトは統計分析のため GA4 を利用します。Cookie を利用し、取得データは統計処理でサイト改善のみに用います。</li>
          <li>Cookies may be used to remember preferences and analyse traffic.<br>サイト設定の記憶やトラフィック解析のために Cookie を使用する場合があります。</li>
          <li>Materials are presented for educational/cultural purposes.<br>本サイト内の資料は教養・文化目的で公開しています。必要に応じてプライバシーに関する注意をご確認ください。</li>
          <li>Unauthorised reproduction is discouraged. All marks belong to their respective owners.<br>無断転載はご遠慮ください。各商標はそれぞれの権利者に帰属します。</li>
        </ul>
        <p style="margin:.6rem 0;color:var(--muted)">© FIXLAG.ART</p>
      </div>`);
    }
    // 将来 copyright / ga を個別ON/OFFしたい場合はここで分岐
    return items.join('');
  }

  // 既存 #footer を「塗りつぶし」 or 無ければ作成
  function injectFooter() {
    const placeholder = document.getElementById('footer');

    // data属性の既定値
    const defaultFlags = { notice: 'on', ga: 'on', copyright: 'on' };

    if (placeholder) {
      // 既存プレースホルダーに中身を描く（←今回の要）
      const flags = {
        notice: placeholder.dataset.notice || defaultFlags.notice,
        ga: placeholder.dataset.ga || defaultFlags.ga,
        copyright: placeholder.dataset.copyright || defaultFlags.copyright,
      };
      placeholder.classList.add('site-footer');
      placeholder.innerHTML = buildFooterHTML(flags);
      return;
    }

    // 置き場が無い場合は末尾に新規追加（従来動作）
    const host = document.querySelector('.content') || document.body;
    const el = document.createElement('div');
    el.id = 'footer';
    el.className = 'site-footer';
    el.innerHTML = buildFooterHTML(defaultFlags);
    host.appendChild(el);
  }

  // 実行
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', injectFooter, { once: true });
  } else {
    injectFooter();
  }
})();
